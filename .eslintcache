[{"D:\\Hochschule Rheinmain\\Web-Engineering\\Pokecoin\\src\\index.js":"1","D:\\Hochschule Rheinmain\\Web-Engineering\\Pokecoin\\src\\context\\user\\UserContext.js":"2","D:\\Hochschule Rheinmain\\Web-Engineering\\Pokecoin\\src\\pages\\shop\\CardShop.js":"3","D:\\Hochschule Rheinmain\\Web-Engineering\\Pokecoin\\src\\pages\\register\\RegisterPageStyles.js":"4","D:\\Hochschule Rheinmain\\Web-Engineering\\Pokecoin\\src\\pages\\main\\MainPage.js":"5","D:\\Hochschule Rheinmain\\Web-Engineering\\Pokecoin\\src\\utiels\\constans\\RESTConstans.js":"6","D:\\Hochschule Rheinmain\\Web-Engineering\\Pokecoin\\src\\workers\\blockWorker.js":"7","D:\\Hochschule Rheinmain\\Web-Engineering\\Pokecoin\\src\\models\\CardPackage.js":"8","D:\\Hochschule Rheinmain\\Web-Engineering\\Pokecoin\\src\\pages\\login\\LoginPage.js":"9"},{"size":517,"mtime":1607953123348,"results":"10","hashOfConfig":"11"},{"size":91,"mtime":1610039672897,"results":"12","hashOfConfig":"11"},{"size":1971,"mtime":1610296986114,"results":"13","hashOfConfig":"11"},{"size":226,"mtime":1607953123353,"results":"14","hashOfConfig":"11"},{"size":5268,"mtime":1610039672908,"results":"15","hashOfConfig":"11"},{"size":373,"mtime":1610039672915,"results":"16","hashOfConfig":"11"},{"size":1052,"mtime":1610039672916,"results":"17","hashOfConfig":"11"},{"size":1040,"mtime":1610296917773,"results":"18","hashOfConfig":"11"},{"size":2068,"mtime":1610294168516,"results":"19","hashOfConfig":"11"},{"filePath":"20","messages":"21","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"22"},"r4h24f",{"filePath":"23","messages":"24","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"25"},{"filePath":"26","messages":"27","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"28","messages":"29","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"30","messages":"31","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"32","usedDeprecatedRules":"33"},{"filePath":"34","messages":"35","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"36"},{"filePath":"37","messages":"38","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"39","messages":"40","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"41","messages":"42","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},"D:\\Hochschule Rheinmain\\Web-Engineering\\Pokecoin\\src\\index.js",[],["43","44"],"D:\\Hochschule Rheinmain\\Web-Engineering\\Pokecoin\\src\\context\\user\\UserContext.js",[],["45","46"],"D:\\Hochschule Rheinmain\\Web-Engineering\\Pokecoin\\src\\pages\\shop\\CardShop.js",["47","48","49"],"D:\\Hochschule Rheinmain\\Web-Engineering\\Pokecoin\\src\\pages\\register\\RegisterPageStyles.js",[],"D:\\Hochschule Rheinmain\\Web-Engineering\\Pokecoin\\src\\pages\\main\\MainPage.js",["50","51"],"import * as crypto from \"crypto\";\r\n\r\nimport React, { useContext, useEffect, useState } from \"react\";\r\n\r\nimport Button from \"@material-ui/core/Button\";\r\n/* eslint-disable import/no-webpack-loader-syntax */\r\nimport DefaultWorker from \"worker-loader!../../workers/blockWorker.js\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport { Grid, Paper } from \"@material-ui/core\";\r\nimport RESTConstans from \"../../utiels/constans/RESTConstans\";\r\nimport { UserContext } from \"../../context/user/UserContext\";\r\nimport { useHistory } from \"react-router-dom\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  grid: {\r\n    width: \"100%\",\r\n    margin: \"0px\",\r\n  },\r\n  paper: {\r\n    padding: theme.spacing(2),\r\n    textAlign: \"center\",\r\n  },\r\n}));\r\n\r\nexport default function MainPage() {\r\n  const { token } = useContext(UserContext);\r\n  const [userName, setUserName] = useState(\"\");\r\n  const [coins, setCoins] = useState(0);\r\n  const [worker, setWorker] = useState();\r\n  const [difficulty, setDifficulty] = useState();\r\n  const history = useHistory();\r\n\r\n  //######################## UI - ELEMENTE ############################################\r\n\r\n  const classes = useStyles();\r\n  /**\r\n   * Beim First render werden Username + CoinAmount gefetcht\r\n   * und der blockWorker initialisiert\r\n   * UI-Element Username\r\n   */\r\n  useEffect(() => {\r\n    fetchUserName();\r\n    fetchCoins();\r\n    fetchDifficulty();\r\n    initBlockWorker();\r\n  }, []);\r\n\r\n  //###################################################################################\r\n\r\n  const mineCoins = () => {\r\n    collectInfoForBlock();\r\n  };\r\n\r\n  const goToShop = () => {\r\n    history.push(\"/cardShop\"); //hängt an aktuelle UL drann\r\n  };\r\n\r\n  async function collectInfoForBlock() {\r\n    // Letzten Block holen und hash rausziehen\r\n    fetchDifficulty();\r\n    const lastBlock = await fetchData(\r\n      RESTConstans.DOMAIN + RESTConstans.LASTBLOCK\r\n    );\r\n    const prevBlockHash = lastBlock.hash;\r\n    //neuen Block bauen mit hash als prevHash\r\n    const newBlock = buildBlock(prevBlockHash);\r\n    //Block wird zum minen dem blockWorker übergeben\r\n    const workerEvent = { block: { ...newBlock }, difficulty: difficulty };\r\n    worker.postMessage(workerEvent);\r\n  }\r\n\r\n  function buildBlock(prevHash) {\r\n    const newBlock = {\r\n      previousHash: prevHash,\r\n      data: \"Sieben Schneeschipper schippen sieben Schippen Schnee.\",\r\n      timestamp: Date.now(),\r\n      nonce: 0,\r\n    };\r\n    return newBlock;\r\n  }\r\n\r\n  async function postOurBlock(postBlock) {\r\n    const response = await postData(\r\n      RESTConstans.DOMAIN + RESTConstans.BLOCKS,\r\n      postBlock\r\n    ).then(() => {\r\n      fetchCoins();\r\n    });\r\n    console.log(\"response\", response);\r\n    return response;\r\n  }\r\n\r\n  function initBlockWorker() {\r\n    const tempWorker = new DefaultWorker();\r\n    tempWorker.onmessage = (event) => {\r\n      const postBlock = { ...event.data };\r\n      console.log(\"Mein Block\" + JSON.stringify(postBlock));\r\n      postOurBlock(postBlock);\r\n    };\r\n    setWorker(tempWorker);\r\n    return () => {\r\n      tempWorker.terminate();\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Coins-amount wird gefecht und im Sate gespeichert\r\n   */\r\n  async function fetchCoins() {\r\n    const response = await fetchData(RESTConstans.DOMAIN + RESTConstans.COINS);\r\n    setCoins(response.amount);\r\n  }\r\n  /**\r\n   * Aktueller UserName wird gefecht und gespeichert\r\n   */\r\n  async function fetchUserName() {\r\n    const response = await fetchData(RESTConstans.DOMAIN + RESTConstans.ME);\r\n    setUserName(response.username);\r\n  }\r\n\r\n  async function fetchDifficulty() {\r\n    const response = await fetchData(\r\n      RESTConstans.DOMAIN + RESTConstans.DIFFICULTY\r\n    );\r\n    setDifficulty(response);\r\n    console.log(\"response nach dem Fetch\", response);\r\n    console.log(\"difficulty\" + difficulty);\r\n  }\r\n\r\n  /**\r\n   * fetchen ausgelagert\r\n   *\r\n   * @param {*} url\r\n   */\r\n  async function fetchData(url) {\r\n    const response = await fetch(url, {\r\n      method: \"GET\",\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        token: token,\r\n      },\r\n    }).then((response) => response.json());\r\n\r\n    return response;\r\n  }\r\n  /**\r\n   *\r\n   * Posten einen Blocks ausgelagert\r\n   * @param {*} url\r\n   * @param {*} Block\r\n   */\r\n  async function postData(url, Block) {\r\n    const response = await fetch(url, {\r\n      method: \"POST\",\r\n      body: JSON.stringify(Block),\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        token: token,\r\n      },\r\n    }).then((response) => response.json());\r\n    return response;\r\n  }\r\n\r\n  return (\r\n    <Grid container spacing={3} className={classes.grid}>\r\n      <Grid item xs={12}>\r\n        <Paper className={classes.paper}>Mining Station</Paper>\r\n      </Grid>\r\n\r\n      <Grid item xs={9}>\r\n        <Paper className={classes.paper}>\r\n          <Button variant=\"contained\" color=\"primary\" onClick={mineCoins}>\r\n            Start Mining\r\n          </Button>\r\n          <Button variant=\"contained\" color=\"primary\" onClick={goToShop}>\r\n            CardShop\r\n          </Button>\r\n        </Paper>\r\n      </Grid>\r\n\r\n      <Grid item xs={3}>\r\n        {userName} - Pokecoins ({coins})\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n}\r\n",["52","53"],"D:\\Hochschule Rheinmain\\Web-Engineering\\Pokecoin\\src\\utiels\\constans\\RESTConstans.js",[],["54","55"],"D:\\Hochschule Rheinmain\\Web-Engineering\\Pokecoin\\src\\workers\\blockWorker.js",[],"D:\\Hochschule Rheinmain\\Web-Engineering\\Pokecoin\\src\\models\\CardPackage.js",[],"D:\\Hochschule Rheinmain\\Web-Engineering\\Pokecoin\\src\\pages\\login\\LoginPage.js",["56"],{"ruleId":"57","replacedBy":"58"},{"ruleId":"59","replacedBy":"60"},{"ruleId":"57","replacedBy":"61"},{"ruleId":"59","replacedBy":"62"},{"ruleId":"63","severity":1,"message":"64","line":3,"column":8,"nodeType":"65","messageId":"66","endLine":3,"endColumn":13},{"ruleId":"63","severity":1,"message":"67","line":9,"column":7,"nodeType":"65","messageId":"66","endLine":9,"endColumn":16},{"ruleId":"68","severity":1,"message":"69","line":32,"column":6,"nodeType":"70","endLine":32,"endColumn":8,"suggestions":"71"},{"ruleId":"63","severity":1,"message":"72","line":1,"column":13,"nodeType":"65","messageId":"66","endLine":1,"endColumn":19},{"ruleId":"68","severity":1,"message":"73","line":46,"column":6,"nodeType":"70","endLine":46,"endColumn":8,"suggestions":"74"},{"ruleId":"57","replacedBy":"75"},{"ruleId":"59","replacedBy":"76"},{"ruleId":"57","replacedBy":"77"},{"ruleId":"59","replacedBy":"78"},{"ruleId":"63","severity":1,"message":"79","line":11,"column":11,"nodeType":"65","messageId":"66","endLine":11,"endColumn":16},"no-native-reassign",["80"],"no-negated-in-lhs",["81"],["80"],["81"],"no-unused-vars","'react' is defined but never used.","Identifier","unusedVar","'useStyles' is assigned a value but never used.","react-hooks/exhaustive-deps","React Hook useEffect has a missing dependency: 'fetchPackages'. Either include it or remove the dependency array.","ArrayExpression",["82"],"'crypto' is defined but never used.","React Hook useEffect has missing dependencies: 'fetchCoins', 'fetchDifficulty', 'fetchUserName', and 'initBlockWorker'. Either include them or remove the dependency array.",["83"],["80"],["81"],["80"],["81"],"'token' is assigned a value but never used.","no-global-assign","no-unsafe-negation",{"desc":"84","fix":"85"},{"desc":"86","fix":"87"},"Update the dependencies array to be: [fetchPackages]",{"range":"88","text":"89"},"Update the dependencies array to be: [fetchCoins, fetchDifficulty, fetchUserName, initBlockWorker]",{"range":"90","text":"91"},[914,916],"[fetchPackages]",[1431,1433],"[fetchCoins, fetchDifficulty, fetchUserName, initBlockWorker]"]